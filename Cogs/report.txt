import discord
from discord.ext import commands
from discord import app_commands, DMChannel
from dotenv import load_dotenv

# 고장 신고 전송 확인
class buttonfunction1(discord.ui.View):
    def __init__(self):
        super().__init__()
    
    @discord.ui.button(label='QnA', style=discord.ButtonStyle.primary, row=1)
    async def button1(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(title="확인", description="QnA 명령어의 고장 신고를 전송하시겠습니까?")
        await interaction.response.send_message("",embed=embed,ephemeral=True,view=buttonfunction_qna())
 
    @discord.ui.button(label='Spec', style=discord.ButtonStyle.success, row=1)
    async def button2(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(title="확인", description="Spec 명령어의 고장 신고를 전송하시겠습니까?")
        await interaction.response.send_message("",embed=embed,ephemeral=True,view=buttonfunction_spec())

# Qna 명령어 고장 신고
class buttonfunction_qna(discord.ui.View):
    def __init__(self):
        super().__init__(timeout=15)    
    @discord.ui.button(label='예', style=discord.ButtonStyle.secondary, row=1)
    async def button3(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(title="전송 완료")
        await interaction.response.send_message("",embed=embed,ephemeral=True)
 
    @discord.ui.button(label='아니오', style=discord.ButtonStyle.danger, row=1)
    async def button4(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(title="전송 취소")
        await interaction.response.send_message("",embed=embed,ephemeral=True)

# Spec 명령어 고장 신고
class buttonfunction_spec(discord.ui.View):
    def __init__(self):
        super().__init__(timeout=15)    
    @discord.ui.button(label='예', style=discord.ButtonStyle.secondary, row=1)
    async def button3(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(title="전송 완료")
        await interaction.response.send_message("",embed=embed,ephemeral=True)
 
    @discord.ui.button(label='아니오', style=discord.ButtonStyle.danger, row=1)
    async def button4(self, interaction: discord.Interaction, button: discord.ui.Button):
        embed = discord.Embed(title="전송 취소")
        await interaction.response.send_message("",embed=embed,ephemeral=True)

# 명령어 고장 신고 안내
class report(commands.Cog):
    def __init__(self,app):
        self.app = app
        
    @app_commands.command(name="report",description="봇 명령어에 문제가 있을 때만 사용해주세요!")
    async def report(self, interaction : discord.Interaction):
        embed = discord.Embed(title="고장 신고", description="어떤 명령어의 고장 신고를 하십니까?")
        await interaction.response.send_message("", embed=embed, view=buttonfunction1(),ephemeral=True)

# 메세지 전송 
class send_message(commands.Cog):
    def __init__(self,app):
        self.app = app
    
    @app_commands.command()
    async def get_channel():
        channel = app_commands.guilds(1151228293715066960)
        await channel.send()       


async def setup(app):
    await app.add_cog(report(app))